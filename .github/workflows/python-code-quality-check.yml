name: Python Code Quality Check

on:
  pull_request:
    branches:
      - main

jobs:
  pylint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.8'
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install pylint
      - name: Run Pylint (Unit Tests)
        run: |
          score=$(pylint *.py | tail -2 | head -1 | grep -o '[0-9]*\.[0-9]*' || echo "0.0")
          echo "Pylint score: $score"
          if (( $(echo "$score >= 9.0" | bc -l) )); then
            echo "✅ Pylint score is above or equal to 9.0"
            exit 0
          else
            echo "❌ Pylint score is below 9.0"
            exit 1
          fi

  mypy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.8'
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install mypy
      - name: Run Mypy (Type Checking)
        run: |
          mypy .

  bandit:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.8'
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install bandit
      - name: Run Bandit (Security Analysis)
        run: |
          bandit -r .

  black:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.8'
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install black
      - name: Run Black (Code Formatter)
        run: |
          black --check .
